       IDENTIFICATION DIVISION.
       PROGRAM-ID. INTEGRATION-SHOWCASE.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT TRANSACTIONS ASSIGN TO "transactions.dat"
               ORGANIZATION IS LINE SEQUENTIAL.
           SELECT ACCEPTED-LOG ASSIGN TO "accepted.txt".
           SELECT REJECTED-LOG ASSIGN TO "rejected.txt".
       DATA DIVISION.
       FILE SECTION.
       FD  TRANSACTIONS.
       01  TRANSACTION-RECORD.
           05  TRANSACTION-STATUS PIC X.
           05  TRANSACTION-AMOUNT PIC 9(6).
       FD  ACCEPTED-LOG.
       01  ACCEPTED-RECORD PIC X(32).
       FD  REJECTED-LOG.
       01  REJECTED-RECORD PIC X(32).
       WORKING-STORAGE SECTION.
       01  EOF-FLAG PIC X VALUE 'N'.
       01  ACCEPTED-COUNT PIC 9(4) VALUE 0.
       01  REJECTED-COUNT PIC 9(4) VALUE 0.
       01  TOTAL-AMOUNT PIC 9(7) VALUE 0.
       01  ACCEPTED-MARKER PIC X(32) VALUE "ACCEPTED ENTRY".
       01  REJECTED-MARKER PIC X(32) VALUE "REJECTED ENTRY".
       01  DISPLAY-BUFFER PIC Z(7).
       PROCEDURE DIVISION.
       MAIN.
       DISPLAY "INTEGRATION SHOWCASE".
       PERFORM RESET-STATE.
       PERFORM PROCESS-TRANSACTIONS.
       MOVE ACCEPTED-COUNT TO DISPLAY-BUFFER.
       DISPLAY DISPLAY-BUFFER.
       MOVE REJECTED-COUNT TO DISPLAY-BUFFER.
       DISPLAY DISPLAY-BUFFER.
       MOVE TOTAL-AMOUNT TO DISPLAY-BUFFER.
       DISPLAY DISPLAY-BUFFER.
       STOP RUN.

       RESET-STATE.
       MOVE 0 TO ACCEPTED-COUNT.
       MOVE 0 TO REJECTED-COUNT.
       MOVE 0 TO TOTAL-AMOUNT.
       MOVE "ACCEPTED ENTRY" TO ACCEPTED-MARKER.
       MOVE "REJECTED ENTRY" TO REJECTED-MARKER.
       MOVE 'N' TO EOF-FLAG.
       EXIT.

       PROCESS-TRANSACTIONS.
       OPEN INPUT TRANSACTIONS.
       OPEN OUTPUT ACCEPTED-LOG.
       OPEN OUTPUT REJECTED-LOG.
       PERFORM UNTIL EOF-FLAG = 'Y'
           READ TRANSACTIONS
               AT END
                   MOVE 'Y' TO EOF-FLAG
               NOT AT END
                   IF TRANSACTION-STATUS = "A"
                       ADD 1 TO ACCEPTED-COUNT
                       ADD TRANSACTION-AMOUNT TO TOTAL-AMOUNT
                       MOVE ACCEPTED-MARKER TO ACCEPTED-RECORD
                       WRITE ACCEPTED-RECORD
                   ELSE
                       ADD 1 TO REJECTED-COUNT
                       MOVE REJECTED-MARKER TO REJECTED-RECORD
                       WRITE REJECTED-RECORD
                   END-IF
           END-READ
       END-PERFORM.
       CLOSE TRANSACTIONS.
       CLOSE ACCEPTED-LOG.
       CLOSE REJECTED-LOG.
       EXIT.
       END PROGRAM INTEGRATION-SHOWCASE.
